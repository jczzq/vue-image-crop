(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["vueImageCrop"]=e():t["vueImageCrop"]=e()})("undefined"!==typeof self?self:this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fb15")}({"0b10":function(t,e,i){"use strict";var n=i("526d"),o=i.n(n);o.a},"0d58":function(t,e,i){var n=i("ce10"),o=i("e11e");t.exports=Object.keys||function(t){return n(t,o)}},"11e9":function(t,e,i){var n=i("52a7"),o=i("4630"),r=i("6821"),s=i("6a99"),h=i("69a8"),f=i("c69a"),a=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?a:function(t,e){if(t=r(t),e=s(e,!0),f)try{return a(t,e)}catch(t){}if(h(t,e))return o(!n.f.call(t,e),t[e])}},1495:function(t,e,i){var n=i("86cc"),o=i("cb7c"),r=i("0d58");t.exports=i("9e1e")?Object.defineProperties:function(t,e){o(t);var i,s=r(e),h=s.length,f=0;while(h>f)n.f(t,i=s[f++],e[i]);return t}},"1eb2":function(t,e,i){var n;"undefined"!==typeof window&&((n=window.document.currentScript)&&(n=n.src.match(/(.+\/)[^/]+\.js$/))&&(i.p=n[1]))},"230e":function(t,e,i){var n=i("d3f4"),o=i("7726").document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},"2aba":function(t,e,i){var n=i("7726"),o=i("32e9"),r=i("69a8"),s=i("ca5a")("src"),h="toString",f=Function[h],a=(""+f).split(h);i("8378").inspectSource=function(t){return f.call(t)},(t.exports=function(t,e,i,h){var f="function"==typeof i;f&&(r(i,"name")||o(i,"name",e)),t[e]!==i&&(f&&(r(i,s)||o(i,s,t[e]?""+t[e]:a.join(String(e)))),t===n?t[e]=i:h?t[e]?t[e]=i:o(t,e,i):(delete t[e],o(t,e,i)))})(Function.prototype,h,function(){return"function"==typeof this&&this[s]||f.call(this)})},"2aeb":function(t,e,i){var n=i("cb7c"),o=i("1495"),r=i("e11e"),s=i("613b")("IE_PROTO"),h=function(){},f="prototype",a=function(){var t,e=i("230e")("iframe"),n=r.length,o="<",s=">";e.style.display="none",i("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(o+"script"+s+"document.F=Object"+o+"/script"+s),t.close(),a=t.F;while(n--)delete a[f][r[n]];return a()};t.exports=Object.create||function(t,e){var i;return null!==t?(h[f]=n(t),i=new h,h[f]=null,i[s]=t):i=a(),void 0===e?i:o(i,e)}},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"32e9":function(t,e,i){var n=i("86cc"),o=i("4630");t.exports=i("9e1e")?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},4588:function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"526d":function(t,e,i){},"52a7":function(t,e){e.f={}.propertyIsEnumerable},5537:function(t,e,i){var n=i("8378"),o=i("7726"),r="__core-js_shared__",s=o[r]||(o[r]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i("2d00")?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(t,e,i){var n=i("7726"),o=i("8378"),r=i("32e9"),s=i("2aba"),h=i("9b43"),f="prototype",a=function(t,e,i){var c,l,u,d,p=t&a.F,v=t&a.G,w=t&a.S,g=t&a.P,m=t&a.B,b=v?n:w?n[e]||(n[e]={}):(n[e]||{})[f],y=v?o:o[e]||(o[e]={}),S=y[f]||(y[f]={});for(c in v&&(i=e),i)l=!p&&b&&void 0!==b[c],u=(l?b:i)[c],d=m&&l?h(u,n):g&&"function"==typeof u?h(Function.call,u):u,b&&s(b,c,u,t&a.U),y[c]!=u&&r(y,c,d),g&&S[c]!=u&&(S[c]=u)};n.core=o,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},"5dbc":function(t,e,i){var n=i("d3f4"),o=i("8b97").set;t.exports=function(t,e,i){var r,s=e.constructor;return s!==i&&"function"==typeof s&&(r=s.prototype)!==i.prototype&&n(r)&&o&&o(t,r),t}},"613b":function(t,e,i){var n=i("5537")("keys"),o=i("ca5a");t.exports=function(t){return n[t]||(n[t]=o(t))}},"626a":function(t,e,i){var n=i("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},6821:function(t,e,i){var n=i("626a"),o=i("be13");t.exports=function(t){return n(o(t))}},"69a8":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"6a99":function(t,e,i){var n=i("d3f4");t.exports=function(t,e){if(!n(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!n(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},7726:function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},"77f1":function(t,e,i){var n=i("4588"),o=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?o(t+e,0):r(t,e)}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"7f35":function(t,e){(function(t){var e='<svg><symbol id="icon-loading" viewBox="0 0 1024 1024"><path d="M874.666667 533.333333l-192 0c-12.8 0-21.333333-8.533333-21.333333-21.333333 0-12.8 8.533333-21.333333 21.333333-21.333333l192 0c12.8 0 21.333333 8.533333 21.333333 21.333333C896 524.8 887.466667 533.333333 874.666667 533.333333zM648.533333 407.466667c-8.533333 8.533333-21.333333 8.533333-29.866667 0-8.533333-8.533333-8.533333-21.333333 0-29.866667l136.533333-136.533333c8.533333-8.533333 21.333333-8.533333 29.866667 0 8.533333 8.533333 8.533333 21.333333 0 29.866667L648.533333 407.466667zM512 896c-12.8 0-21.333333-8.533333-21.333333-21.333333l0-192c0-12.8 8.533333-21.333333 21.333333-21.333333s21.333333 8.533333 21.333333 21.333333l0 192C533.333333 887.466667 524.8 896 512 896zM512 362.666667c-12.8 0-21.333333-8.533333-21.333333-21.333333L490.666667 149.333333c0-12.8 8.533333-21.333333 21.333333-21.333333s21.333333 8.533333 21.333333 21.333333l0 192C533.333333 354.133333 524.8 362.666667 512 362.666667zM270.933333 782.933333c-8.533333 8.533333-21.333333 8.533333-29.866667 0s-8.533333-21.333333 0-29.866667l136.533333-136.533333c8.533333-8.533333 21.333333-8.533333 29.866667 0 8.533333 8.533333 8.533333 21.333333 0 29.866667L270.933333 782.933333zM375.466667 407.466667l-136.533333-136.533333c-8.533333-8.533333-8.533333-21.333333 0-29.866667s21.333333-8.533333 29.866667 0l136.533333 136.533333c8.533333 8.533333 8.533333 21.333333 0 29.866667C398.933333 413.866667 384 413.866667 375.466667 407.466667zM362.666667 512c0 12.8-8.533333 21.333333-21.333333 21.333333L149.333333 533.333333c-12.8 0-21.333333-8.533333-21.333333-21.333333 0-12.8 8.533333-21.333333 21.333333-21.333333l192 0C354.133333 490.666667 362.666667 499.2 362.666667 512zM648.533333 616.533333l136.533333 136.533333c8.533333 8.533333 8.533333 21.333333 0 29.866667-8.533333 8.533333-21.333333 8.533333-29.866667 0l-136.533333-136.533333c-8.533333-8.533333-8.533333-21.333333 0-29.866667C625.066667 610.133333 640 610.133333 648.533333 616.533333z"  ></path></symbol><symbol id="icon-remove" viewBox="0 0 1024 1024"><path d="M908.644739 217.714534H115.355261c-14.149255 0-25.587771-11.438517-25.587771-25.587772 0-14.128789 11.438517-25.592888 25.587771-25.592888h793.289478c14.150278 0 25.587771 11.465123 25.587771 25.592888 0 14.149255-11.437493 25.587771-25.587771 25.587772zM652.741441 115.357308H371.256512c-14.150278 0-25.592888-11.438517-25.592888-25.592888 0-14.122649 11.44261-25.588795 25.592888-25.588795h281.484929c14.155395 0 25.594935 11.467169 25.594935 25.588795 0 14.155395-11.438517 25.592888-25.594935 25.592888zM396.845307 780.689509V345.665671c0-14.127765 11.437493-25.592888 25.587771-25.592888 14.155395 0 25.592888 11.466146 25.592888 25.592888v435.023838c0 14.154371-11.437493 25.592888-25.592888 25.592888-14.149255 0-25.587771-11.437493-25.587771-25.592888z m179.127703 0V345.665671c0-14.127765 11.441587-25.592888 25.592888-25.592888 14.150278 0 25.587771 11.466146 25.587772 25.592888v435.023838c0 14.154371-11.437493 25.592888-25.587772 25.592888s-25.592888-11.437493-25.592888-25.592888zM217.717603 294.483988c14.151301 0 25.588795 11.467169 25.588795 25.587771v537.386181c0 28.251438 22.930245 51.183729 51.181683 51.183729h435.023838c28.250414 0 51.181683-22.931269 51.181683-51.183729V320.071759c0-14.121626 11.437493-25.587771 25.588795-25.587771 14.154371 0 25.592888 11.467169 25.592888 25.587771v562.980092c0 42.401716-34.369785 76.771501-76.770478 76.771501H268.89417c-42.400692 0-76.770478-34.369785-76.770478-76.771501V320.071759c0.001023-14.120602 11.443633-25.587771 25.593911-25.587771z"  ></path></symbol></svg>',i=function(){var t=document.getElementsByTagName("script");return t[t.length-1]}(),n=i.getAttribute("data-injectcss"),o=function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{var i=function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()};document.addEventListener("DOMContentLoaded",i,!1)}else document.attachEvent&&n(t,e);function n(t,e){var i=t.document,n=!1,o=function(){n||(n=!0,e())},r=function t(){try{i.documentElement.doScroll("left")}catch(e){return void setTimeout(t,50)}o()};r(),i.onreadystatechange=function(){"complete"==i.readyState&&(i.onreadystatechange=null,o())}}},r=function(t,e){e.parentNode.insertBefore(t,e)},s=function(t,e){e.firstChild?r(t,e.firstChild):e.appendChild(t)};function h(){var t,i;t=document.createElement("div"),t.innerHTML=e,e=null,i=t.getElementsByTagName("svg")[0],i&&(i.setAttribute("aria-hidden","true"),i.style.position="absolute",i.style.width=0,i.style.height=0,i.style.overflow="hidden",s(i,document.body))}if(n&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}o(h)})(window)},"7f7f":function(t,e,i){var n=i("86cc").f,o=Function.prototype,r=/^\s*function ([^ (]*)/,s="name";s in o||i("9e1e")&&n(o,s,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},8378:function(t,e){var i=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=i)},"86cc":function(t,e,i){var n=i("cb7c"),o=i("c69a"),r=i("6a99"),s=Object.defineProperty;e.f=i("9e1e")?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),o)try{return s(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},"8b97":function(t,e,i){var n=i("d3f4"),o=i("cb7c"),r=function(t,e){if(o(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return r(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:r}},9093:function(t,e,i){var n=i("ce10"),o=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},"9b43":function(t,e,i){var n=i("d8e8");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}},"9def":function(t,e,i){var n=i("4588"),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},"9e1e":function(t,e,i){t.exports=!i("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},aa77:function(t,e,i){var n=i("5ca1"),o=i("be13"),r=i("79e5"),s=i("fdef"),h="["+s+"]",f="​",a=RegExp("^"+h+h+"*"),c=RegExp(h+h+"*$"),l=function(t,e,i){var o={},h=r(function(){return!!s[t]()||f[t]()!=f}),a=o[t]=h?e(u):s[t];i&&(o[i]=a),n(n.P+n.F*h,"String",o)},u=l.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(a,"")),2&e&&(t=t.replace(c,"")),t};t.exports=l},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c366:function(t,e,i){var n=i("6821"),o=i("9def"),r=i("77f1");t.exports=function(t){return function(e,i,s){var h,f=n(e),a=o(f.length),c=r(s,a);if(t&&i!=i){while(a>c)if(h=f[c++],h!=h)return!0}else for(;a>c;c++)if((t||c in f)&&f[c]===i)return t||c||0;return!t&&-1}}},c5f6:function(t,e,i){"use strict";var n=i("7726"),o=i("69a8"),r=i("2d95"),s=i("5dbc"),h=i("6a99"),f=i("79e5"),a=i("9093").f,c=i("11e9").f,l=i("86cc").f,u=i("aa77").trim,d="Number",p=n[d],v=p,w=p.prototype,g=r(i("2aeb")(w))==d,m="trim"in String.prototype,b=function(t){var e=h(t,!1);if("string"==typeof e&&e.length>2){e=m?e.trim():u(e,3);var i,n,o,r=e.charCodeAt(0);if(43===r||45===r){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+e}for(var s,f=e.slice(2),a=0,c=f.length;a<c;a++)if(s=f.charCodeAt(a),s<48||s>o)return NaN;return parseInt(f,n)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof p&&(g?f(function(){w.valueOf.call(i)}):r(i)!=d)?s(new v(b(e)),i,p):b(e)};for(var y,S=i("9e1e")?a(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;S.length>x;x++)o(v,y=S[x])&&!o(p,y)&&l(p,y,c(v,y));p.prototype=w,w.constructor=p,i("2aba")(n,d,p)}},c69a:function(t,e,i){t.exports=!i("9e1e")&&!i("79e5")(function(){return 7!=Object.defineProperty(i("230e")("div"),"a",{get:function(){return 7}}).a})},ca5a:function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},cb7c:function(t,e,i){var n=i("d3f4");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},ce10:function(t,e,i){var n=i("69a8"),o=i("6821"),r=i("c366")(!1),s=i("613b")("IE_PROTO");t.exports=function(t,e){var i,h=o(t),f=0,a=[];for(i in h)i!=s&&n(h,i)&&a.push(i);while(e.length>f)n(h,i=e[f++])&&(~r(a,i)||a.push(i));return a}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},fab2:function(t,e,i){var n=i("7726").document;t.exports=n&&n.documentElement},fb15:function(t,e,i){"use strict";i.r(e);i("1eb2"),i("7f7f");var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-image-crop"},[i("img",{staticClass:"show-img",attrs:{src:t._f("fileSrc")(t.currentValue)}}),t.hasRemove?i("svg",{staticClass:"icon icon-remove",attrs:{"aria-hidden":"true"},on:{click:function(e){e.stopPropagation(),t.$emit("remove")}}},[i("use",{attrs:{"xlink:href":"#icon-remove"}})]):t._e(),t._t("default"),i("input",{directives:[{name:"show",rawName:"v-show",value:1==t.state,expression:"state==1"}],ref:"path",staticClass:"path",attrs:{accept:"image/*",type:"file"},on:{change:t.imageChange}}),i("div",{directives:[{name:"show",rawName:"v-show",value:2==t.state,expression:"state==2"},{name:"touch",rawName:"v-touch:move",value:t.move,expression:"move",arg:"move"},{name:"touch",rawName:"v-touch:end",value:t.end,expression:"end",arg:"end"},{name:"touch",rawName:"v-touch:scale",value:t.scale,expression:"scale",arg:"scale"}],ref:"fileView",staticClass:"file-view"},[i("img",{ref:"file",staticClass:"file",attrs:{src:t.url,alt:""}}),i("div",{ref:"imgView",staticClass:"imgView"},[i("div",{ref:"imgViewBox",staticClass:"imgViewBox"},[i("img",{ref:"file2",staticClass:"file",attrs:{src:t.url,alt:""}})])]),i("div",{staticClass:"ctrl"},[i("div",{staticClass:"back",attrs:{flex:"33",layout:"column","layout-align":"center center"},on:{click:t.back}},[t._v("取消")]),i("div",{staticClass:"rotate",attrs:{flex:"33",layout:"column","layout-align":"center center"},on:{click:t.rotateChange}},[t._v("旋转")]),i("div",{staticClass:"submit",attrs:{flex:"33",layout:"column","layout-align":"center center"},on:{click:t.submitFile}},[t._v("确认")])])])],2)},o=[],r=(i("c5f6"),i("7f35"),{name:"m-image-crop",data:function(){return{state:1,top:null,left:null,url:null,img:new Image,maxSize:3,initViewWidth:.74,borderWidth:1,view:{width:0,height:0},fileSize:{width:0,height:0,top:0,left:0},fileInitSize:{width:0,height:0},filRealitySize:{width:0,height:0},viewBox:{width:0,height:0,left:0,top:0},rotate:0,point1:null,point2:null,indicator:{visible:!1}}},props:{value:{type:Object,required:!0,default:function(){return{}}},proportion:{type:Object,default:function(){return{w:2,h:1}}},quality:{type:Number,default:.92},hasRemove:{type:Boolean,default:!1},skipCrop:{type:Boolean,default:!1},config:{type:Object,default:function(){return{size:1200,isSlice:!0,path:null}}}},components:{},beforeDestroy:function(){document.removeEventListener("touchmove",this.preventDefault,!1),document.body.removeChild(this.$refs.fileView)},mounted:function(){document.body.appendChild(this.$refs.fileView),this.currentValue.origin={},this.$nextTick(function(){this.initViewSize()})},methods:{imageChange:function(t){var e=this,i=t.target.files[0];if(this.$emit("change",i),i){var n=URL.createObjectURL(i);this.currentValue.origin=i,this.img.src=n,this.img.onload=function(){e.filRealitySize={width:e.img.width,height:e.img.height};var t=function(){e.indicator.visible=!0,e.loadImg(),setTimeout(function(){e.indicator.visible=!1,e.state=2,e.$nextTick(function(){this.file2SizePosition()})},800)};if(e.skipCrop)e.uploadCanvas();else if(e.config.isSlice&&e.filRealitySize.width/e.filRealitySize.height==e.proportion.w/e.proportion.h){var i=window.confirm("文件已符合规定尺寸，是否直接使用？");i?e.uploadCanvas():t()}else t()}}},loadImg:function(){var t=this.filRealitySize.width;t>this.config.size&&(t=this.config.size);var e=t*(this.filRealitySize.height/this.filRealitySize.width),i=document.createElement("canvas"),n=i.getContext("2d");switch(this.rotate){case 0:i.setAttribute("width",t),i.setAttribute("height",e),n.drawImage(this.img,0,0,t,e);break;case 1:t+=e,e=t-e,t-=e,i.setAttribute("width",t),i.setAttribute("height",e),n.translate(t,0),n.rotate(90*Math.PI/180),n.drawImage(this.img,0,0,e,t);break;case 2:i.setAttribute("width",t),i.setAttribute("height",e),n.translate(t,e),n.rotate(180*Math.PI/180),n.drawImage(this.img,0,0,t,e);break;case 3:t+=e,e=t-e,t-=e,i.setAttribute("width",t),i.setAttribute("height",e),n.translate(0,e),n.rotate(270*Math.PI/180),n.drawImage(this.img,0,0,e,t);break}if(this.url=i.toDataURL(this.currentValue.origin.type,this.quality),t/e>=this.view.width/this.view.height){var o={width:this.view.width,height:e/t*this.view.width};o.height<this.viewBox.height&&(o.height=this.viewBox.height,o.width=t/e*o.height),this.fileSize.width=o.width,this.fileSize.height=o.height,this.fileSize.left=0,this.fileSize.top=(this.view.height-this.fileSize.height)/2}else{var r={width:t/e*this.view.height,height:this.view.height};r.width<this.viewBox.width&&(r.width=this.viewBox.width,r.height=e/t*r.width),this.fileSize.height=r.height,this.fileSize.width=r.width,this.fileSize.top=0,this.fileSize.left=(this.view.width-this.fileSize.width)/2}this.fileInitSize={width:this.fileSize.width,height:this.fileSize.height},this.fileSizePosition()},initViewSize:function(){this.view.width=document.documentElement.clientWidth,this.view.height=document.documentElement.clientHeight,this.$refs.fileView.style.width=this.view.width+"px",this.$refs.fileView.style.height=this.view.height+"px",this.$refs.imgView.style.width=this.view.width+"px",this.$refs.imgView.style.height=this.view.height+"px",this.view.width*this.initViewWidth*this.proportion.h/this.proportion.w<this.view.height*this.initViewWidth?this.viewBox={width:Math.floor(this.view.width*this.initViewWidth),height:Math.floor(this.view.width*this.initViewWidth*this.proportion.h/this.proportion.w)}:this.viewBox={width:Math.floor(this.view.height*this.initViewWidth*this.proportion.w/this.proportion.h),height:Math.floor(this.view.height*this.initViewWidth)},this.viewBox.left=Math.floor((this.view.width-this.viewBox.width)/2),this.viewBox.top=Math.floor((this.view.height-this.viewBox.height)/2),this.$refs.imgViewBox.style.width=this.viewBox.width+"px",this.$refs.imgViewBox.style.height=this.viewBox.height+"px",this.$refs.imgViewBox.style.top=this.viewBox.top+"px",this.$refs.imgViewBox.style.left=this.viewBox.left+"px"},fileSizePosition:function(){this.$refs.file.style.top=this.fileSize.top+"px",this.$refs.file.style.left=this.fileSize.left+"px",this.$refs.file.style.width=this.fileSize.width+"px",this.$refs.file.style.height=this.fileSize.height+"px",this.file2SizePosition()},file2SizePosition:function(){this.$refs.file2.style.top=this.$refs.file.offsetTop-(this.$refs.imgViewBox.offsetTop+this.borderWidth)+"px",this.$refs.file2.style.left=this.$refs.file.offsetLeft-(this.$refs.imgViewBox.offsetLeft+this.borderWidth)+"px",this.$refs.file2.style.width=this.$refs.file.offsetWidth+"px",this.$refs.file2.style.height=this.$refs.file.offsetHeight+"px"},setAttr:function(t,e){e||e.length},checkPosition:function(){var t=!1;this.fileSize.top>=this.viewBox.top+this.borderWidth?this.fileSize.top=this.viewBox.top+this.borderWidth:this.fileSize.top+this.fileSize.height<=this.viewBox.top+this.viewBox.height+this.borderWidth&&(this.fileSize.top=this.viewBox.top+this.viewBox.height-this.fileSize.height+this.borderWidth),this.fileSize.left>=this.viewBox.left+this.borderWidth?this.fileSize.left=this.viewBox.left+this.borderWidth:this.fileSize.left+this.fileSize.width<=this.viewBox.left+this.viewBox.width+this.borderWidth&&(this.fileSize.left=this.viewBox.left+this.viewBox.width-this.fileSize.width+this.borderWidth),this.fileSize.width<=this.viewBox.width&&(this.fileSize.width=this.viewBox.width,this.fileSize.height=this.fileInitSize.height/this.fileInitSize.width*this.fileSize.width),this.fileSize.height<=this.viewBox.height&&(this.fileSize.height=this.viewBox.height,this.fileSize.width=this.fileInitSize.width/this.fileInitSize.height*this.fileSize.height),this.fileSize.width>this.fileInitSize.width*this.maxSize&&(this.fileSize.width=this.fileInitSize.width*this.maxSize,this.fileSize.height=this.fileInitSize.height/this.fileInitSize.width*this.fileSize.width,t=!0),this.fileSize.height>this.fileInitSize.height*this.maxSize&&(this.fileSize.height=this.fileInitSize.height*this.maxSize,this.fileSize.width=this.fileInitSize.width/this.fileInitSize.height*this.fileSize.height,t=!0),t&&(this.fileSize.left=this.$refs.file.offsetLeft,this.fileSize.top=this.$refs.file.offsetTop)},move:function(t){this.top&&(this.fileSize.top=Math.floor(this.$refs.file.offsetTop+t.touches[0].clientY-this.top),this.fileSize.left=Math.floor(this.$refs.file.offsetLeft+t.touches[0].clientX-this.left),this.checkPosition(),this.fileSizePosition()),this.top=t.touches[0].clientY,this.left=t.touches[0].clientX},scale:function(t){if(this.point1){var e=this.distance(t.touches),i={width:this.fileSize.width,height:this.fileSize.height},n={width:i.width*e,height:i.height*e};this.fileSize.width=n.width,this.fileSize.height=n.height,this.fileSize.left=this.$refs.file.offsetLeft-(n.width-i.width)/2,this.fileSize.top=this.$refs.file.offsetTop-(n.height-i.height)/2,this.checkPosition(),this.fileSizePosition()}this.point1=JSON.stringify(t.touches[0]).length<3?t.touches[0]:JSON.parse(JSON.stringify(t.touches[0])),this.point2=JSON.stringify(t.touches[1]).length<3?t.touches[1]:JSON.parse(JSON.stringify(t.touches[1]))},distance:function(t){var e=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2)),i=Math.sqrt(Math.pow(this.point1.clientX-this.point2.clientX,2)+Math.pow(this.point1.clientY-this.point2.clientY,2)),n=e/i;return n},imgSizeScale:function(){var t;return t=this.viewBox.width/this.$refs.file.offsetWidth*this.filRealitySize.width<this.config.size?Number((this.viewBox.width/this.$refs.file.offsetWidth*this.filRealitySize.width/this.viewBox.width).toFixed(15)):this.config.size/this.viewBox.width,t},setCanvas:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=this.imgSizeScale();t.setAttribute("width",this.viewBox.width*i),t.setAttribute("height",this.viewBox.height*i),e.drawImage(this.$refs.file,(this.$refs.file.offsetLeft-this.viewBox.left-this.borderWidth)*i,(this.$refs.file.offsetTop-this.viewBox.top-this.borderWidth)*i,this.$refs.file.offsetWidth*i,this.$refs.file.offsetHeight*i);var n=t.toDataURL("image/jpeg",this.quality);this.$set(this.currentValue,"base64",n),this.currentValue.id=null,this.$emit("submit",this.currentValue)},uploadCanvas:function(){var t=this.filRealitySize.width;t>this.config.size&&(t=this.config.size);var e=t*(this.filRealitySize.height/this.filRealitySize.width),i=document.createElement("canvas"),n=i.getContext("2d");i.setAttribute("width",t),i.setAttribute("height",e),n.drawImage(this.img,0,0,t,e);var o=i.toDataURL("image/jpeg",this.quality);this.$set(this.currentValue,"base64",o),this.currentValue.id=null,this.$emit("submit",this.currentValue)},end:function(){this.top=null,this.left=null,this.point1=null,this.point2=null},preventDefault:function(t){t.preventDefault()},addEventDefault:function(){document.addEventListener("touchmove",this.preventDefault,!1)},removeEventDefault:function(){document.removeEventListener("touchmove",this.preventDefault,!1)},submitFile:function(){this.state=1,this.$refs.path.value=null,this.setCanvas()},rotateChange:function(){this.rotate++,this.rotate%=4,this.loadImg()},back:function(){this.state=1,this.$refs.path.value=null,this.$emit("cancel")}},watch:{state:function(t){2===t?this.addEventDefault():this.removeEventDefault()}},computed:{currentValue:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},filters:{fileSrc:function(t){return t?t.base64?t.base64:t.id?this.config.path+t.id:"":""}},directives:{touch:{bind:function(t,e){var i,n,o=e.arg,r=0,s="";function h(t,e){return 180*Math.atan2(e,t)/Math.PI}function f(t,e,i,n){var o=e-n,r=i-t,s=0;if(Math.abs(r)<2&&Math.abs(o)<2)return"tap";var f=h(r,o);return f>=-45&&f<45?s="swiperight":f>=45&&f<135?s="swipeup":f>=-135&&f<-45?s="swipedown":(f>=135&&f<=180||f>=-180&&f<-135)&&(s="swipeleft"),s}t.addEventListener("touchstart",function(t){i=t.touches[0].pageX,n=t.touches[0].pageY,r=setTimeout(function(){r=0,"press"===o&&e.value(t)},500)},!1),t.addEventListener("touchmove",function(t){clearTimeout(r),r=0,1===t.touches.length?"move"===o&&e.value(t):2===event.touches.length&&"scale"===o&&e.value(t)}),t.addEventListener("touchend",function(t){var h,a;switch(h=t.changedTouches[0].pageX,a=t.changedTouches[0].pageY,s=f(i,n,h,a),clearTimeout(r),"end"===o&&e.value(t),s){case 0:break;case"tap":"tap"===o&&e.value(t);break;case"swipeup":"swipeup"===o&&e.value(t);break;case"swipedown":"swipedown"===o&&e.value(t);break;case"swipeleft":"swipeleft"===o&&e.value(t);break;case"swiperight":"swiperight"===o&&e.value(t);break;default:break}},!1)}}}}),s=r;i("0b10");function h(t,e,i,n,o,r,s,h){var f,a="function"===typeof t?t.options:t;if(e&&(a.render=e,a.staticRenderFns=i,a._compiled=!0),n&&(a.functional=!0),r&&(a._scopeId="data-v-"+r),s?(f=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},a._ssrRegister=f):o&&(f=h?function(){o.call(this,this.$root.$options.shadowRoot)}:o),f)if(a.functional){a._injectStyles=f;var c=a.render;a.render=function(t,e){return f.call(e),c(t,e)}}else{var l=a.beforeCreate;a.beforeCreate=l?[].concat(l,f):[f]}return{exports:t,options:a}}var f=h(s,n,o,!1,null,null,null);f.options.__file="m-image-crop.vue";var a=f.exports,c={version:"0.0.1",install:function(t){t.component(a.name,a)}};e["default"]=c},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}})["default"]});
//# sourceMappingURL=vueImageCrop.umd.min.js.map